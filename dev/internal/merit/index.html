<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>merit.jl · QuantumACES.jl</title><meta name="title" content="merit.jl · QuantumACES.jl"/><meta property="og:title" content="merit.jl · QuantumACES.jl"/><meta property="twitter:title" content="merit.jl · QuantumACES.jl"/><meta name="description" content="Documentation for QuantumACES.jl."/><meta property="og:description" content="Documentation for QuantumACES.jl."/><meta property="twitter:description" content="Documentation for QuantumACES.jl."/><meta property="og:url" content="https://evanhockings.github.io/QuantumACES.jl/internal/merit/"/><meta property="twitter:url" content="https://evanhockings.github.io/QuantumACES.jl/internal/merit/"/><link rel="canonical" href="https://evanhockings.github.io/QuantumACES.jl/internal/merit/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">QuantumACES.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../guide/">Package Guide</a></li><li><a class="tocitem" href="../../creation/">Creating Circuits and Noise Models</a></li><li><a class="tocitem" href="../../performance/">Package Performance</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../QuantumACES/">QuantumACES.jl</a></li><li><a class="tocitem" href="../tableau/">tableau.jl</a></li><li><a class="tocitem" href="../noise/">noise.jl</a></li><li><a class="tocitem" href="../noises/depolarising/">noises/depolarising.jl</a></li><li><a class="tocitem" href="../noises/lognormal/">noises/lognormal.jl</a></li><li><a class="tocitem" href="../circuit/">circuit.jl</a></li><li><a class="tocitem" href="../circuits/rotated_planar/">circuits/rotated_planar.jl</a></li><li><a class="tocitem" href="../circuits/unrotated_planar/">circuits/unrotated_planar.jl</a></li><li><a class="tocitem" href="../circuits/heavy_hex/">circuits/heavy_hex.jl</a></li><li><a class="tocitem" href="../stim/">stim.jl</a></li><li><a class="tocitem" href="../tuples/">tuples.jl</a></li><li><a class="tocitem" href="../design/">design.jl</a></li><li><a class="tocitem" href="../rand_design/">rand_design.jl</a></li><li class="is-active"><a class="tocitem" href>merit.jl</a><ul class="internal"><li><a class="tocitem" href="#Public-functions"><span>Public functions</span></a></li><li><a class="tocitem" href="#Private-functions"><span>Private functions</span></a></li></ul></li><li><a class="tocitem" href="../optimise_weights/">optimise_weights.jl</a></li><li><a class="tocitem" href="../optimise_tuples/">optimise_tuples.jl</a></li><li><a class="tocitem" href="../estimate/">estimate.jl</a></li><li><a class="tocitem" href="../simulate/">simulate.jl</a></li><li><a class="tocitem" href="../device/">device.jl</a></li><li><a class="tocitem" href="../scaling/">scaling.jl</a></li><li><a class="tocitem" href="../kwargs/">kwargs.jl</a></li><li><a class="tocitem" href="../utils/">utils.jl</a></li><li><a class="tocitem" href="../io/">io.jl</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li><a class="is-disabled">API</a></li><li class="is-active"><a href>merit.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>merit.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/evanhockings/QuantumACES.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/evanhockings/QuantumACES.jl/blob/main/docs/src/internal/merit.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="merit.jl"><a class="docs-heading-anchor" href="#merit.jl">merit.jl</a><a id="merit.jl-1"></a><a class="docs-heading-anchor-permalink" href="#merit.jl" title="Permalink"></a></h1><h2 id="Public-functions"><a class="docs-heading-anchor" href="#Public-functions">Public functions</a><a id="Public-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Public-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.Merit" href="#QuantumACES.Merit"><code>QuantumACES.Merit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Merit</code></pre><p>Merit parameters for an experimental design.</p><p><strong>Fields</strong></p><ul><li><code>circuit_param::AbstractCircuitParameters</code>: Circuit parameters.</li><li><code>noise_param::AbstractNoiseParameters</code>: Noise parameters.</li><li><code>tuple_set_data::TupleSetData</code>: <a href="../tuples/#QuantumACES.TupleSetData"><code>TupleSetData</code></a> object that generates the tuple set.</li><li><code>tuple_times::Vector{Float64}</code>: Time taken to implement the circuit corresponding to each tuple, normalised according to the basic tuple set.</li><li><code>shot_weights::Vector{Float64}</code>: Shot weights for each tuple in the set, which add to 1.</li><li><code>experiment_numbers::Vector{Int}</code>: Number of experiments for each tuple in the set.</li><li><code>experiment_number::Int</code>: Total number of experiments.</li><li><code>N::Int</code>: Number of gate eigenvalues.</li><li><code>N_marginal::Int</code>: Number of marginal gate eigenvalues.</li><li><code>N_relative::Int</code>: Number of relative precision marginal gate eigenvalues.</li><li><code>G::Int</code>: Total number of gates.</li><li><code>gls_expectation::Float64</code>: Expected normalised RMS error for the generalised least squares (GLS) gate eigenvalue estimator vector.</li><li><code>gls_variance::Float64</code>: Normalised RMS error variance for the GLS gate eigenvalue estimator vector.</li><li><code>gls_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the GLS gate eigenvalue estimator covariance matrix.</li><li><code>gls_marginal_expectation::Float64</code>: Expected normalised RMS error for the marginal GLS gate eigenvalue estimator vector.</li><li><code>gls_marginal_variance::Float64</code>: Normalised RMS error variance for the marginal GLS gate eigenvalue estimator vector.</li><li><code>gls_marginal_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the marginal GLS gate eigenvalue estimator covariance matrix.</li><li><code>gls_relative_expectation::Float64</code>: Expected normalised RMS error for the relative precision marginal GLS gate eigenvalue estimator vector.</li><li><code>gls_relative_variance::Float64</code>: Normalised RMS error variance for the relative precision marginal GLS gate eigenvalue estimator vector.</li><li><code>gls_relative_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the relative precision marginal GLS gate eigenvalue estimator covariance matrix.</li><li><code>wls_expectation::Float64</code>: Expected normalised RMS error for the weighted least squares (WLS) gate eigenvalue estimator vector.</li><li><code>wls_variance::Float64</code>: Normalised RMS error variance for the WLS gate eigenvalue estimator vector.</li><li><code>wls_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the WLS gate eigenvalue estimator covariance matrix.</li><li><code>wls_marginal_expectation::Float64</code>: Expected normalised RMS error for the marginal WLS gate eigenvalue estimator vector.</li><li><code>wls_marginal_variance::Float64</code>: Normalised RMS error variance for the marginal WLS gate eigenvalue estimator vector.</li><li><code>wls_marginal_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the marginal WLS gate eigenvalue estimator covariance matrix.</li><li><code>wls_relative_expectation::Float64</code>: Expected normalised RMS error for the relative precision marginal WLS gate eigenvalue estimator vector.</li><li><code>wls_relative_variance::Float64</code>: Normalised RMS error variance for the relative precision marginal WLS gate eigenvalue estimator vector.</li><li><code>wls_relative_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the relative precision marginal WLS gate eigenvalue estimator covariance matrix.</li><li><code>ols_expectation::Float64</code>: Expected normalised RMS error for the ordinary least squares (OLS) gate eigenvalue estimator vector.</li><li><code>ols_variance::Float64</code>: Normalised RMS error variance for the OLS gate eigenvalue estimator vector.</li><li><code>ols_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the OLS gate eigenvalue estimator covariance matrix.</li><li><code>ols_marginal_expectation::Float64</code>: Expected normalised RMS error for the marginal OLS gate eigenvalue estimator vector.</li><li><code>ols_marginal_variance::Float64</code>: Normalised RMS error variance for the marginal OLS gate eigenvalue estimator vector.</li><li><code>ols_marginal_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the marginal OLS gate eigenvalue estimator covariance matrix.</li><li><code>ols_relative_expectation::Float64</code>: Expected normalised RMS error for the relative precision marginal OLS gate eigenvalue estimator vector.</li><li><code>ols_relative_variance::Float64</code>: Normalised RMS error variance for the relative precision marginal OLS gate eigenvalue estimator vector.</li><li><code>ols_relative_cov_eigenvalues::Vector{Float64}</code>: Eigenvalues of the relative precision marginal OLS gate eigenvalue estimator covariance matrix.</li><li><code>cond_num::Float64</code>: Condition number of the design matrix, the ratio of the largest and smallest singular values.</li><li><code>pinv_norm::Float64</code>: Pseudoinverse norm of the design matrix, the inverse of the smallest singular value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L1-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_covariance-Tuple{Design, Vector{Vector{Float64}}, Vector{Vector{Float64}}}" href="#QuantumACES.calc_covariance-Tuple{Design, Vector{Vector{Float64}}, Vector{Vector{Float64}}}"><code>QuantumACES.calc_covariance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_covariance(d::Design; epsilon::Real = 1e-10, weight_time::Bool = true, warning::Bool = true)
calc_covariance(d::Design, gate_eigenvalues::Vector{Float64}; epsilon::Real = 1e-10, weight_time::Bool = true, warning::Bool = true)
calc_covariance(d::Design, eigenvalues_ensemble::Vector{Vector{Float64}}, covariance_ensemble::Vector{Vector{Float64}}; epsilon::Real = 1e-10, weight_time::Bool = true, warning::Bool = true)
calc_covariance(d::Design, eigenvalues_experiment_ensemble::Vector{Vector{Vector{Float64}}}, covariance_experiment_ensemble::Vector{Vector{Vector{Float64}}}; epsilon::Real = 1e-10, weight_time::Bool = true, warning::Bool = true)</code></pre><p>Returns the circuit eigenvalue estimator covariance matrix for the design <code>d</code> with gate eigenvalues <code>gate_eigenvalues</code>, eigenvalue ensemble <code>eigenvalues_ensemble</code>, and covariance eigenvalue ensemble <code>covariance_ensemble</code>. Eigenvalue variances are set to a minimum value <code>epsilon</code> and the covariance matrix is adjusted by the times factor if <code>weight_time</code> is <code>true</code>, and if <code>warning</code> is <code>true</code>, warns that if <code>d.full_covariance</code> is <code>false</code> this will only generate the diagonal of the covariance matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L197-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_covariance_log-Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Float64}}" href="#QuantumACES.calc_covariance_log-Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Float64}}"><code>QuantumACES.calc_covariance_log</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_covariance_log(covariance::SparseMatrixCSC{Float64, Int}, eigenvalues::Vector{Float64})
calc_covariance_log(d::Design; warning::Bool = true)</code></pre><p>Returns the covariance matrix of the circuit log-eigenvalues corresponding to the circuit eigenvalues <code>eigenvalues</code> with covariance matrix <code>covariance</code>, using values generated from the design <code>d</code> and, if <code>warning</code> is <code>true</code>, warns that if <code>d.full_covariance</code> is <code>false</code> then this will only generate the diagonal of the covariance matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L350-L355">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_gate_probabilities_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_gate_probabilities_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_gate_probabilities_covariance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_gate_probabilities_covariance(d::Design; ls_type::Symbol = :gls, est_type::Symbol = :ordinary, unpad::Bool = false)
calc_gate_probabilities_covariance(d::Design, covariance_log::SparseMatrixCSC{Float64, Int}; ls_type::Symbol = :gls, est_type::Symbol = :ordinary, unpad::Bool = false)</code></pre><p>Returns the padded gate error probabilities estimator covariance matrix for the least squares estimator specified by <code>ls_type</code> (<code>:gls</code>, <code>:wls</code>, or <code>:ols</code>) corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>, with estimator type <code>est_type</code> (<code>:ordinary</code>, <code>:marginal</code>, or <code>:relative</code>). Instead returns the unpadded gate error probabilities estimator covariance matrix if <code>unpad</code> is <code>true</code>, which is stripped of the covariance with the identity error probabilities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L694-L700">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_gls_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_gls_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_gls_covariance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_gls_covariance(d::Design)
calc_gls_covariance(d::Design, covariance_log::SparseMatrixCSC{Float64, Int})</code></pre><p>Returns the gate eigenvalue estimator covariance matrix for the generalised least squares (GLS) estimator corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L550-L555">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_gls_moments-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_gls_moments-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_gls_moments</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_gls_moments(d::Design; est_type::Symbol = :ordinary)
calc_gls_moments(d::Design, covariance_log::SparseMatrixCSC{Float64, Int}; est_type::Symbol = :ordinary)</code></pre><p>Returns the expectation and variance of the normalised RMS error for the generalised least squares (GLS) estimator corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>, with estimator type <code>est_type</code> (<code>:ordinary</code>, <code>:marginal</code>, or <code>:relative</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L798-L803">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_ls_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_ls_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_ls_covariance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_ls_covariance(d::Design; ls_type::Symbol = :gls, est_type::Symbol = :ordinary)
calc_ls_covariance(d::Design, covariance_log::SparseMatrixCSC{Float64, Int}; ls_type::Symbol = :gls, est_type::Symbol = :ordinary)</code></pre><p>Returns the gate eigenvalue estimator covariance matrix for the least squares estimator specified by <code>ls_type</code> (<code>:gls</code>, <code>:wls</code>, or <code>:ols</code>) corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>, with estimator type <code>est_type</code> (<code>:ordinary</code>, <code>:marginal</code>, or <code>:relative</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L631-L636">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_ls_moments-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_ls_moments-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_ls_moments</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_ls_moments(d::Design; ls_type::Symbol = :gls, est_type::Symbol = :ordinary, est_weight::Float64 = 0.5)
calc_ls_moments(d::Design, covariance_log::SparseMatrixCSC{Float64, Int}; ls_type::Symbol = :gls, est_type::Symbol = :ordinary, est_weight::Float64 = 0.5)</code></pre><p>Returns the expectation and variance of the normalised RMS error for the least squares estimator specified by <code>ls_type</code> (<code>:gls</code>, <code>:wls</code>, or <code>:ols</code>) corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>, with estimator type <code>est_type</code> (<code>:ordinary</code>, <code>:marginal</code>, or <code>:relative</code>). If <code>est_type</code> is instead set to <code>:sum</code> or <code>:prod</code>, computes the arithmetic or geometric mean of the ordinary and relative precision moments, weighted by <code>est_weight</code>, the weighting allocated to the ordinary precision moments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L870-L876">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_merit-Tuple{Design}" href="#QuantumACES.calc_merit-Tuple{Design}"><code>QuantumACES.calc_merit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_merit(d::Design; warning::Bool = true)
calc_merit(d_rand::RandDesign; warning::Bool = true)</code></pre><p>Returns a <a href="#QuantumACES.Merit"><code>Merit</code></a> object corresponding to the design <code>d</code> or randomised design <code>d_rand</code>, displaying a warning if the design does not have full covariance matrix data and <code>warning</code> is <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L924-L929">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_ols_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_ols_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_ols_covariance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_ols_covariance(d::Design)
calc_ols_covariance(d::Design, covariance_log::SparseMatrixCSC{Float64, Int})</code></pre><p>Returns the gate eigenvalue estimator covariance matrix for the ordinary least squares (OLS) estimator corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L605-L610">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_ols_moments-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_ols_moments-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_ols_moments</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_ols_moments(d::Design; est_type::Symbol = :ordinary)
calc_ols_moments(d::Design, covariance_log::SparseMatrixCSC{Float64, Int}; est_type::Symbol = :ordinary)</code></pre><p>Returns the expectation and variance of the normalised RMS error for the ordinary least squares (OLS) estimator corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>, with estimator type <code>est_type</code> (<code>:ordinary</code>, <code>:marginal</code>, or <code>:relative</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L846-L851">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_precision_matrix-Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Float64}, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_precision_matrix-Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Float64}, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_precision_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_precision_matrix(design_matrix::SparseMatrixCSC{Float64, Int}, gate_eigenvalues::Vector{Float64}, covariance_log_inv::SparseMatrixCSC{Float64, Int})
calc_precision_matrix(d::Design, gate_eigenvalues::Vector{Float64}; diagonal::Bool = false)
calc_precision_matrix(d::Design; diagonal::Bool = false)</code></pre><p>Returns the precision matrix, namely the inverse of the generalised least squares gate eigenvalue estimator covariance matrix, corresponding to the design <code>d</code> with design matrix <code>design_matrix</code>, gate eigenvalues <code>gate_eigenvalues</code> and circuit log-eigenvalue estimator covariance matrix inverse <code>covariance_log_inv</code>. Ordinarily this yields the precision matrix for generalise least squares, but if <code>diagonal</code> is <code>true</code> it calculates the inverse of the diagonal of the covariance matrix, rather than the inverse of the full matrix, yielding the precision matrix for both generalised and weighted least squares if the circuit eigenvalue estimators were uncorrelated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L746-L753">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_wls_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_wls_covariance-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_wls_covariance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_wls_covariance(d::Design)
calc_wls_covariance(d::Design, covariance_log::SparseMatrixCSC{Float64, Int})</code></pre><p>Returns the gate eigenvalue estimator covariance matrix for the weighted least squares (WLS) estimator corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L575-L580">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_wls_moments-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}" href="#QuantumACES.calc_wls_moments-Tuple{Design, SparseArrays.SparseMatrixCSC{Float64, Int64}}"><code>QuantumACES.calc_wls_moments</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_wls_moments(d::Design; est_type::Symbol = :ordinary)
calc_wls_moments(d::Design, covariance_log::SparseMatrixCSC{Float64, Int}; est_type::Symbol = :ordinary)</code></pre><p>Returns the expectation and variance of the normalised RMS error for the weighted least squares (WLS) estimator corresponding to the design <code>d</code> with circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>, with estimator type <code>est_type</code> (<code>:ordinary</code>, <code>:marginal</code>, or <code>:relative</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L822-L827">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.get_marginal_gate_covariance-Tuple{Design, LinearAlgebra.Symmetric{Float64, Matrix{Float64}}}" href="#QuantumACES.get_marginal_gate_covariance-Tuple{Design, LinearAlgebra.Symmetric{Float64, Matrix{Float64}}}"><code>QuantumACES.get_marginal_gate_covariance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_marginal_gate_covariance(d::Design, gate_eigenvalues_cov::Symmetric{Float64, Matrix{Float64}})</code></pre><p>Returns the marginal gate eigenvalue estimator covariance matrix corresponding to the gate eigenvalue estimator covariance matrix <code>gate_eigenvalues_cov</code> for the design <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L472-L476">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.get_pad_transform-Tuple{Design, Symbol}" href="#QuantumACES.get_pad_transform-Tuple{Design, Symbol}"><code>QuantumACES.get_pad_transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_pad_transform(d::Design, est_type::Symbol; probabilities::Bool = false)</code></pre><p>Returns a transform matrix that pads gate eigenvalues, or gate error probabilities if <code>probabilities</code> is <code>true</code>, whose type depends on the estimator type <code>est_type</code> (<code>:ordinary</code>, <code>:marginal</code>, or <code>:relative</code>), with identity eigenvaleus or error probabilities, respectively, calculated using the gate data of the design <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L506-L510">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.get_relative_gate_covariance-Tuple{Design, LinearAlgebra.Symmetric{Float64, Matrix{Float64}}}" href="#QuantumACES.get_relative_gate_covariance-Tuple{Design, LinearAlgebra.Symmetric{Float64, Matrix{Float64}}}"><code>QuantumACES.get_relative_gate_covariance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_relative_gate_covariance(d::Design, gate_eigenvalues_cov::Symmetric{Float64, Matrix{Float64}})</code></pre><p>Returns the relative gate eigenvalue estimator covariance matrix corresponding to the gate eigenvalue estimator covariance matrix <code>gate_eigenvalues_cov</code> for the design <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L489-L493">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.get_transform-Tuple{Design, Symbol}" href="#QuantumACES.get_transform-Tuple{Design, Symbol}"><code>QuantumACES.get_transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_transform(d::Design, est_type::Symbol)</code></pre><p>Returns a transform matrix that maps gate eigenvalues to gate eigenvalues of type depending on the estimator type <code>est_type</code> (<code>:ordinary</code>, <code>:marginal</code>, or <code>:relative</code>), calculated using the gate data of the design <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L450-L454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.get_wht_transform-Tuple{Design, Symbol}" href="#QuantumACES.get_wht_transform-Tuple{Design, Symbol}"><code>QuantumACES.get_wht_transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_wht_transform(d::Design, est_type::Symbol; inverse::Bool = false)</code></pre><p>Returns a transform matrix that maps padded gate error probabilities to padded gate eigenvalues, or the inverse transform if <code>inverse</code> is <code>true</code>, whose type depends on the estimator type <code>est_type</code> (<code>:ordinary</code>, :marginal<code>, or</code>:relative<code>), calculated using the gate data of the design</code>d`.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L528-L532">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.nrmse_pdf-Tuple{Vector{Float64}, Vector{Float64}}" href="#QuantumACES.nrmse_pdf-Tuple{Vector{Float64}, Vector{Float64}}"><code>QuantumACES.nrmse_pdf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nrmse_pdf(cov_eigenvalues::Vector{Float64}, nrmse_values::Vector{Float64}; epsilon::Real = 1e-5)</code></pre><p>Returns the probability density function (PDF) for the normalised RMS error (NRMSE) of the gate eigenvalue estimator vector, which follows a generalised chi-squared distribution and whose covariance matrix has eigenvalues <code>cov_eigenvalues</code>, at the coordinates specified by <code>nrmse_values</code>. Does not calculate values when the normal approximation to the PDF is less than a factor of <code>epsilon</code> of its maximum value.</p><p>Calculation follows Eq. 3.2 of <code>Computing the distribution of quadratic forms in normal variables</code> by J. P. Imhof (1961).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L1073-L1080">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.sparse_covariance_inv-Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Int64}}" href="#QuantumACES.sparse_covariance_inv-Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Int64}}"><code>QuantumACES.sparse_covariance_inv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sparse_covariance_inv(covariance_log::SparseMatrixCSC{Float64, Int}, mapping_lengths::Vector{Int}; epsilon::Real = 1e-12, warning::Bool = true)</code></pre><p>Returns the inverse of the sparse block diagonal circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>, where the block sizes are specified by <code>mapping_lengths</code>, ensuring a smallest eigenvalue <code>epsilon</code> if the Cholesky factorisation fails, and warning if <code>warning</code> is <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L429-L433">source</a></section></article><h2 id="Private-functions"><a class="docs-heading-anchor" href="#Private-functions">Private functions</a><a id="Private-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Private-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.calc_covariance_eigenvalues-Tuple{Design, Vector{Float64}}" href="#QuantumACES.calc_covariance_eigenvalues-Tuple{Design, Vector{Float64}}"><code>QuantumACES.calc_covariance_eigenvalues</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_covariance_eigenvalues(d::Design)
calc_covariance_eigenvalues(d::Design, gate_eigenvalues::Vector{Float64})</code></pre><p>Returns the covariance matrix eigenvalue ensemble for the design <code>d</code> with gate eigenvalues <code>gate_eigenvalues</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L165-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.get_covariance_mapping_data-Tuple{Design}" href="#QuantumACES.get_covariance_mapping_data-Tuple{Design}"><code>QuantumACES.get_covariance_mapping_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_covariance_mapping_data(d::Design)</code></pre><p>Returns covariance matrix mapping index data for the design <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L139-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.nrmse_moments-Tuple{LinearAlgebra.Symmetric{Float64, Matrix{Float64}}}" href="#QuantumACES.nrmse_moments-Tuple{LinearAlgebra.Symmetric{Float64, Matrix{Float64}}}"><code>QuantumACES.nrmse_moments</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nrmse_moments(gate_eigenvalues_cov::Symmetric{Float64, Matrix{Float64}})    
nrmse_moments(gate_eigenvalues_cov_eigenvalues::Vector{Float64})</code></pre><p>Returns the expectation and variance of the normalised RMS error, as determined either by the gate eigenvalue estimator covariance matrix <code>gate_eigenvalues_cov</code> or its eigenvalues <code>gate_eigenvalues_cov_eigenvalues</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L666-L671">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.nrmse_pdf_integrand-Tuple{Float64, Float64, Vector{Float64}}" href="#QuantumACES.nrmse_pdf_integrand-Tuple{Float64, Float64, Vector{Float64}}"><code>QuantumACES.nrmse_pdf_integrand</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nrmse_pdf_integrand(u::Float64, x::Float64, norm_cov_eigenvalues::Vector{Float64})</code></pre><p>Returns the integrand of the Imhof method CDF for the distribution of the NRMSE.</p><p>Calculation follows Eq. 3.2 of <code>Computing the distribution of quadratic forms in normal variables</code> by J. P. Imhof (1961).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L1058-L1064">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QuantumACES.sparse_covariance_inv_factor-Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Int64}}" href="#QuantumACES.sparse_covariance_inv_factor-Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, Vector{Int64}}"><code>QuantumACES.sparse_covariance_inv_factor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sparse_covariance_inv_factor(covariance_log::SparseMatrixCSC{Float64, Int}, mapping_lengths::Vector{Int}; epsilon::Real = 1e-12, warning::Bool = true)</code></pre><p>Returns the inverse of the lower Cholesky factor of the sparse block diagonal circuit log-eigenvalue estimator covariance matrix <code>covariance_log</code>, where the block sizes are specified by <code>mapping_lengths</code>, ensuring a smallest eigenvalue <code>epsilon</code> if the Cholesky factorisation fails, and warning if <code>warning</code> is <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/evanhockings/QuantumACES.jl/blob/8e4212d8407d097e63cb1a6697ec2a462fc1b6a5/src/merit.jl#L373-L377">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../rand_design/">« rand_design.jl</a><a class="docs-footer-nextpage" href="../optimise_weights/">optimise_weights.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Tuesday 1 April 2025 04:33">Tuesday 1 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
